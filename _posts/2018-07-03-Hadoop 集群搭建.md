---
title: Hadoop 集群搭建
layout: post
tags: Hadoop
categories: Hadoop
---
##### 搭建过那么多次hadoop也没好好总结下，这次公司发了电脑，跑3台虚拟机完全不虚，所以想在自己的机器上搭建hadoop,学习大数据做相关实验，为了避免以后再重复学习，找资料花费大量时间，做笔记如下
#####一切内容均摘自cloudera官网
## 0、参考资料
官方参考文档：[http://www.cloudera.com/]()  

官方安装文档：[https://www.cloudera.com/documentation/enterprise/latest/topics/install_cm_cdh.html]()

官方__版本和下载信息__： [https://www.cloudera.com/documentation/enterprise/release-notes/topics/rg_vd.html]()
## 1、离线下载资料： 

CM:cloudera-manager-daemons-5.15.0-1.cm5150.p0.62.el7.x86_64.rpm  

下载地址  [https://archive.cloudera.com/cm5/redhat/7/x86_64/cm/5.15.0/RPMS/x86_64/4/]()

CDH: 

- CDH-5.15.0-1.cdh5.15.0.p0.21-el7.parcel  

- CDH-5.15.0-1.cdh5.15.0.p0.21-el7.parcel.sha1

- 下载地址 [http://archive.cloudera.com/cdh5/parcels/5.15.0/]()

## 2、安装之前的准备： 
配置网络名称  
1. 将主机设置为唯一名称  
        sudo hostnamectl set-hostname ccc.example.com  
2. 编辑 `/etc/hosts`文件使用群集中每个主机的IP地址和完全限定的域名（FQDN）。您也可以添加非限定名称以添加非限定名称  
        192.168.221.10 hadoop1.teradata.com hadoop1
        192.168.221.11 hadoop2.teradata.com hadoop2
        192.168.221.12 hadoop3.teradata.com hadoop3 
3. 编辑host的hostname`/etc/sysconfig/network`用FQDN：  
        HOSTNAME=hadoop1.teradata.com
4. 验证host是不是唯一的标识对于network    
- `uname -a`(验证输出是不是和hostname相同)
- `ifconfig`(验证IP地址)  
- `host -v -t A $(hostname)` (验证输出是不是符合hostname命令，IP地址是不是和ifconfig命令中的eth0,bond0一样)  

## 3、权限设置  

我们使用root用户的最高权限，但是不同主机之间不要配置无密码登录，步骤如下：  
只配置主节点到子节点的无密登录就行  
先删除所有密钥 `rm -rf ~/.ssh/*`  

        # ssh-keygen -t rsa
        # ssh-copy-id master
        # ssh-copy-id slave1
        # ssh-copy-id slave2

        # ssh localhost  
        
## 4、JDK安装

## 5、其他事项
- 关闭防火墙
      systemctl stop firewalld
      systemctl disable firewalld
- SELINUX关闭  

        setenforce 0
        sed -i "s/SELINUX=enforcing/SELINUX=disabled/" /etc/selinux/config
        iptables --flush
        reboot  #重启生效
        
- 设置文件打开数量及最大进程数
        cp /etc/security/limits.conf /etc/security/limits.conf.bak
        echo "* soft nproc 32000" >>/etc/security/limits.conf
        echo "* hard nproc 32000" >>/etc/security/limits.conf
        echo "* soft nofile 65535" >>/etc/security/limits.conf
        echo "* hard nofile 65535" >>/etc/security/limits.conf
- 同步时间
安装ntp服务
        yum -y install ntp
启动ntp服务，并设置开机自启 
        systemctl start ntpd
        systemctl enable ntpd